# QQ音乐下载器

一个基于Python的QQ音乐下载工具，支持单曲搜索下载和歌单批量下载。

## 功能特点

- **单曲下载** - 支持搜索并下载单首歌曲
- **歌单下载** - 支持下载公开歌单
- **登录支持** - 支持QQ/微信登录，可下载VIP歌曲
- **多音质选择** - 支持FLAC、MP3_320、MP3_128等音质
- **统一凭证管理** - 登录、检查、刷新一站式管理

## 安装要求

### 系统要求
- Python 3.7+
- Windows/macOS/Linux

### 安装依赖
```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 登录与凭证管理（推荐）
```bash
python credential.py
```

程序会自动检测凭证状态：
- **无凭证**：进入登录界面
- **有凭证**：进入凭证管理界面

#### 登录方式选择：
- `1` - QQ二维码登录
- `2` - 微信二维码登录  

#### 凭证管理功能：
- `1` - 检查凭证状态
- `2` - 手动刷新凭证
- `3` - 显示凭证信息
- `4` - 重新登录

### 2. 单曲下载
```bash
python song.py
```
按照提示：
1. 输入要搜索的歌曲名
2. 选择音质偏好（y: FLAC优先 / n: MP3_320优先）
3. 从搜索结果中选择要下载的歌曲

**新特性**：自动检测凭证过期并刷新，无需手动操作

### 3. 歌单下载
```bash
python songlist.py
```
按照提示：
1. 输入用户的musicid
2. 选择音质偏好
3. 从歌单列表中选择要下载的歌单
4. 预览歌曲列表并确认下载

**新特性**：自动检测凭证过期并刷新，支持批量并发下载

## 文件说明

- `song.py` - 单曲搜索下载
- `songlist.py` - 歌单下载
- `credential.py` - 登录与凭证管理（合并了原signin.py和credential.py）
- `requirements.txt` - 项目依赖
- `qqmusic_cred.pkl` - 登录凭证（自动生成）
- `windows打包文件` - 见Releases

## 音质说明

### 高品质模式 (FLAC优先)
- FLAC → MP3_320 → MP3_128
- 优先下载无损音质

### 标准模式 (MP3优先)
- MP3_320 → MP3_128
- 优先下载高品质MP3

## 更新日志

### v2.0.4
- 自动添加歌词封面(800px)
- 一键下载所有歌单

### v2.0.3
- 合并登录与凭证管理功能
- 添加自动凭证刷新机制
- 统一凭证管理界面

### v2.0.2
- 基础单曲和歌单下载功能
- 多音质支持
- 登录功能

### v2.0.1
- 初始版本


## 注意事项

1. **VIP歌曲**：需要登录且有VIP权限才能下载高音质版本
2. **收藏歌单**：只能下载自己的收藏歌单，他人收藏歌单不公开
3. **文件命名**：自动清理文件名中的非法字符
4. **重复下载**：如果文件已存在会自动跳过
5. **网络问题**：如遇下载失败，程序会自动尝试低音质版本
6. **凭证管理**：凭证过期时会自动刷新，无需手动干预

## 技术特性

- **异步处理**：使用asyncio提高下载效率
- **自动重试**：下载失败时自动降级音质重试
- **并发控制**：限制并发下载数量，避免被封IP
- **错误恢复**：完善的异常处理和错误提示
- **智能缓存**：凭证自动保存和刷新

## 免责声明

本项目仅用于学习和研究目的，请勿用于商业用途。下载的音乐文件请在24小时内删除，支持正版音乐。

## 问题反馈

如遇到问题，请检查：
1. 网络连接是否正常
2. 是否已正确登录
3. musicid是否正确
4. 歌单是否为公开状态
5. 凭证文件是否完整

常见问题：
- **凭证过期**：程序会自动刷新，无需手动操作
- **下载失败**：尝试切换网络环境或稍后重试
- **搜索无结果**：检查关键词是否正确

## 作者信息

- **作者**：GeQian
- **GitHub**：[https://github.com/tooplick](https://github.com/tooplick)

---

**享受音乐，支持正版！**